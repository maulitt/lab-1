I. Что происходит при прерывании скрипта text-trap.sh? Объясните, почему.

В скрипте мы, споользуя команду trap, определили поведение скрипта при получении сигнала SIGINT (ctrl+c).
Поэтому после запуска скрипта и нажатия ctrl+c скрипт получил сигнал SIGINT и вывел Аварийное завершение, как мы ему и велели делать.

II. Напишите, по какой причине выводы команды ls -l /proc/self и ls -l /proc/$$ отличаются?

В переменной $ хранится PID текущего проесса. На момент вызова этой переменной в команде в ней сохранён пид текущего процесса bash, а вызов self происходит при выполнении команды и эта ссылка указывает на подкатолог текущего процесса, т.е. ссылается на сам ls -l.

III. Напишите, какие дескрипторы в выводе команды ls -l /proc/self/fd отвечают за stdin, stdout, stderr.

0 - за ввод(stdin), 1 - зв вывод (stdout), 2 - за вывод ошибок (stderr)

IV. Что происходит с дескрипторами при перенаправлении потоков stdout и stderr в файлы при выполнении команды ls -l /proc/self/fd > /tmp/ls.out 2> /tmp/ls.err?

Теперь они связаны с другими файлами (указывают на них) (стандартные ввод/вывод это ведь тоже файлы (всё есть файл)).
То есть с самими дескрипторами ничего не происходит, просто упомянутым файлам присваиваются они (1 и 2).

V. Запишите эту же команду, добавив к ней перенаправление потока stdin. Что изменилось?

ls -l /proc/self/fd > /tmp/ls.out 2> /tmp/ls.err </tmp/ls.in
Теперь с нулевым дескриптором связан этот файл: 
lr-x------. 1 student student 64 дек 10 20:51 0 -> /tmp/ls.in

VI. Какой эффект наблюдается при выполнении команды exec ps -l?

exec заменяет shell указанной командой.

[student@localhost ~]$ sh

sh-5.0$ ps -l

F S   UID     PID    PPID  C PRI  NI ADDR SZ WCHAN  TTY          TIME CMD

0 S  1000   11101   10958  0  80   0 - 56670 -      pts/0    00:00:00 bash

0 S  1000   11330   11101  0  80   0 - 56313 -      pts/0    00:00:00 sh 

0 R  1000   11332   11330  0  80   0 - 54699 -      pts/0    00:00:00 ps

видим, что у дочернего интерпретатора sh пид 11330.  Выполним экзек

sh-5.0$ exec ps -l

F S   UID     PID    PPID  C PRI  NI ADDR SZ WCHAN  TTY          TIME CMD

0 S  1000   11101   10958  0  80   0 - 56670 -      pts/0    00:00:00 bash

0 R  1000   11330   11101  0  80   0 - 54699 -      pts/0    00:00:00 ps

exec'ом мы заменили итерпретатор командой ps и теперь у неё пид sh - 11330

VII. Что означает pos при выводе содержимого файла /proc/$$/fdinfo/3?

pos содержит информацию о текущей позиции указателя (курсора). Вывод в файл или ввод из файла меняет его "положение".

В данном задании он находится на 14 символе. Если ввести ещё что-то, он переместится. Он учитывает и непечатные символы, судя по его значению, такие как перенос строки, например.

VIII. Существует ли возможность читать содержимое файла test.out даже после его удаления? Почему так происходит?

При удалении файла rm'ом мы удаляем ссылку на inode файла. Но с ним ещё связан дескритор процесса, то есть пока процесс обращается к нему, в пространстве существует как бы его копия, порождённая процессом (когда мы связали его с ним).

Поэтому, если обратиться к нему через дескриптор, мы получим его содержимое, ведь в дескриторе ещё жива ссылка на него.

Возможно, "полностью" удалить его будет потенциально проблематично. Может быть, надо связать дескриптор с другим файлом, тогда мы навсегда потеряем его.

(Не уверена так ли это, очень интересно, хотелось бы знать. Лекцию я слушала, может, что-то не так поняла)

